<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
  <Arguments/>
  <Context/>
  <Model>
    <DataType name="dataTypeFiles">
      <PropertyDef name="id"/>
      <PropertyDef name="name">
        <Property name="label">文件名</Property>
      </PropertyDef>
      <PropertyDef name="size">
        <Property name="label">大小</Property>
      </PropertyDef>
      <PropertyDef name="percent">
        <Property name="label">进度</Property>
      </PropertyDef>
      <PropertyDef name="status">
        <Property name="dataType">int</Property>
        <Property name="label">状态</Property>
        <Property name="mapping">
          <Property name="mapValues">
            <Collection>
              <Entity>
                <Property name="value">队列中</Property>
                <Property name="key">0</Property>
              </Entity>
              <Entity>
                <Property name="value">正在上传</Property>
                <Property name="key">2</Property>
              </Entity>
              <Entity>
                <Property name="value">失败</Property>
                <Property name="key">4</Property>
              </Entity>
              <Entity>
                <Property name="value">完成</Property>
                <Property name="key">5</Property>
              </Entity>
            </Collection>
          </Property>
        </Property>
      </PropertyDef>
    </DataType>
  </Model>
  <View>
    <ClientEvent name="onCreate">self.checkButton = function(cur,tagName,status){&#xD;
	this.set(&quot;^&quot; + tagName +&quot;.disabled&quot;, cur &amp;&amp; cur.get(&quot;status&quot;) != status);   &#xD;
}</ClientEvent>
    <DataSet id="dsBtreport">
      <ClientEvent name="onLoadData">var cur = view.id('dsBtreport').getDataAsync('#',function(cur){&#xD;
	view.checkButton(cur,'reportCheck','1');&#xD;
});</ClientEvent>
      <Property name="dataType">[Btreport]</Property>
      <Property name="dataProvider">btreportPR#queryBtreport</Property>
      <Property name="pageSize">20</Property>
      <Property name="parameter">
        <Entity>
          <Property name="sectionChief">${loginUser.getUsername()}</Property>
          <Property name="status">1</Property>
        </Entity>
      </Property>
    </DataSet>
    <DataSet id="dsUsers">
      <Property name="dataProvider">bdf2.userMaintain#loadUsers2</Property>
      <Property name="dataType">[User]</Property>
    </DataSet>
    <UpdateAction id="uaBtreport">
      <Property name="dataResolver">btreportPR#saveBtreport</Property>
      <UpdateItem>
        <Property name="dataSet">dsBtreport</Property>
      </UpdateItem>
    </UpdateAction>
    <ToolBar>
      <DataPilot>
        <Property name="itemCodes">pages</Property>
        <Property name="dataSet">dsBtreport</Property>
        <Property name="dataPath"></Property>
      </DataPilot>
      <ToolBarButton>
        <ClientEvent name="onClick">var cur=view.id('dsBtreport').getData('#');
var dateNow = new Date();
if (cur) {	
	cur.set(&quot;sectionChiefDate&quot;,dateNow);
	var dialog=view.id('diaBtreport');
	dialog.show();	
}
</ClientEvent>
        <Property name="caption">审阅</Property>
        <Property name="icon"> url(>skin>common/icons.gif) -300px -60px</Property>
        <Property name="tags">reportCheck</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">var cur=view.id('dsBtreport').getData('#');&#xD;
if (cur) {&#xD;
	view.id('diaSeeBtreport').show();&#xD;
}</ClientEvent>
        <Property name="caption">浏览</Property>
        <Property name="icon">url(>skin>common/icons.gif) -40px -100px</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">var dsBtreport = view.get(&quot;#dsBtreport&quot;);&#xD;
var cur=view.id('dsBtreport').getData('#');&#xD;
if (cur) {	&#xD;
	var dateNow = new Date();&#xD;
	cur.set(&quot;sectionChiefDate&quot;,dateNow);&#xD;
	var dialog=view.id('diaRejectBtreport');&#xD;
	dialog.show();&#xD;
}  </ClientEvent>
        <Property name="caption">驳回</Property>
        <Property name="icon">url(>skin>common/icons.gif) -100px -0px</Property>
        <Property name="tags">reportCheck</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">var cur=view.id('dsBtreport').getData('#');&#xD;
var dateNow = new Date();&#xD;
if (cur) {&#xD;
	cur.set(&quot;sectionChiefDate&quot;,dateNow);&#xD;
	var dialog=view.id('diaSubmitBtreport');&#xD;
	dialog.show();&#xD;
}</ClientEvent>
        <Property name="caption">提交到部领导</Property>
        <Property name="icon">url(>skin>common/icons.gif) -140px -180px</Property>
        <Property name="tags">reportCheck</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">view.id('dgBtreport').set(&quot;showFilterBar&quot;,!view.id('dgBtreport').get(&quot;showFilterBar&quot;));</ClientEvent>
        <Property name="caption">自定义查询</Property>
        <Property name="icon"> url(>skin>common/icons.gif) -20px -40px</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">var dsBtreport = view.get(&quot;#dsBtreport&quot;);&#xD;
dsBtreport.flushAsync();</ClientEvent>
        <Property name="icon">url(>skin>common/icons.gif) -40px -240px</Property>
        <Property name="caption">刷新</Property>
      </ToolBarButton>
    </ToolBar>
    <DataGrid id="dgBtreport">
      <ClientEvent name="onCurrentChange">var cur = view.id('dsBtreport').getDataAsync('#',function(cur){&#xD;
	view.checkButton(cur,'reportCheck','1');&#xD;
});</ClientEvent>
      <Property name="readOnly">true</Property>
      <Property name="dataSet">dsBtreport</Property>
      <Property name="dataPath"></Property>
      <Property name="height">300</Property>
      <Property name="filterMode">clientSide</Property>
      <Property name="showFilterBar">false</Property>
      <Property name="rowHeight">22</Property>
      <Property name="fixedColumnCount">9</Property>
      <RowNumColumn/>
      <DataColumn>
        <Property name="property">writingPersonName</Property>
        <Property name="name">WritingPersonName</Property>
        <Property name="width">70</Property>
        <Property name="align">center</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="property">wPerDepartment</Property>
        <Property name="name">WPerDepartment</Property>
        <Property name="width">80</Property>
        <Property name="align">center</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="property">btpersonName</Property>
        <Property name="width">120</Property>
        <Property name="name">btpersonName</Property>
      </DataColumn>
      <DataColumn name="bttime">
        <Property name="property">bttime</Property>
        <Property name="width">90</Property>
      </DataColumn>
      <DataColumn name="bttask">
        <Property name="property">bttask</Property>
        <Property name="width">150</Property>
      </DataColumn>
      <DataColumn name="btplace">
        <Property name="property">btplace</Property>
        <Property name="width">90</Property>
      </DataColumn>
      <DataColumn name="keyword">
        <Property name="property">keyword</Property>
        <Property name="width">120</Property>
      </DataColumn>
      <DataColumn name="jobcontent">
        <Property name="property">jobcontent</Property>
        <Property name="width">200</Property>
      </DataColumn>
      <DataColumn>
        <ClientEvent name="onRenderCell">var status = arg.data.get(&quot;status&quot;);&#xD;
if(status == 1){&#xD;
	arg.dom.style.color = &quot;red&quot;;&#xD;
}&#xD;
else if(status == 2){&#xD;
	arg.dom.style.color = &quot;green&quot;;&#xD;
}&#xD;
else{&#xD;
	arg.dom.style.color = &quot;&quot;;&#xD;
}&#xD;
arg.processDefault = true;</ClientEvent>
        <Property name="property">status</Property>
        <Property name="name">Status</Property>
        <Property name="align">left</Property>
        <Property name="width">120</Property>
        <Editor/>
      </DataColumn>
      <DataColumn name="technicalquestion">
        <Property name="property">technicalquestion</Property>
        <Property name="width">120</Property>
      </DataColumn>
      <DataColumn name="remainedproblem">
        <Property name="property">remainedproblem</Property>
        <Property name="width">150</Property>
      </DataColumn>
      <DataColumn name="conclusion">
        <Property name="property">conclusion</Property>
        <Property name="width">120</Property>
      </DataColumn>
      <DataColumn name="gainandadvice">
        <Property name="property">gainandadvice</Property>
        <Property name="width">120</Property>
      </DataColumn>
      <DataColumn>
        <Property name="property">sectionChiefName</Property>
        <Property name="name">SectionChiefName</Property>
        <Property name="width">120</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="property">sectionChiefDate</Property>
        <Property name="name">SectionChiefDate</Property>
        <Property name="width">120</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="property">sectionChiefComment</Property>
        <Property name="name">SectionChiefComment</Property>
        <Property name="width">120</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="property">departmentHeadName</Property>
        <Property name="name">DepartmentHeadName</Property>
        <Property name="width">120</Property>
        <Property name="resizeable">true</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="name">DepartmentHeadDate</Property>
        <Property name="property">departmentHeadDate</Property>
        <Property name="width">120</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="property">departmentHeadComment</Property>
        <Property name="name">DepartmentHeadComment</Property>
        <Property name="width">120</Property>
        <Property name="resizeable">true</Property>
        <Editor/>
      </DataColumn>
      <DataColumn>
        <Property name="property">miji</Property>
        <Property name="name">miji</Property>
        <Property name="align">left</Property>
        <Property name="width">120</Property>
      </DataColumn>
    </DataGrid>
    <GroupBox>
      <Property name="caption">报告共享人</Property>
      <Property name="collapseable">false</Property>
      <Buttons/>
      <Children>
        <ToolBar>
          <DataPilot>
            <Property name="itemCodes">pages</Property>
            <Property name="dataSet">dsBtreport</Property>
            <Property name="dataPath">#.btReportSharePerson</Property>
          </DataPilot>
          <ToolBarButton>
            <ClientEvent name="onClick">var cur=view.id('dsBtreport').getData('#.#btReportSharePerson');&#xD;
if (cur) {&#xD;
	view.id('diaSeeSharePerson').show();&#xD;
}</ClientEvent>
            <Property name="caption">浏览</Property>
            <Property name="icon">url(>skin>common/icons.gif) -40px -100px</Property>
          </ToolBarButton>
          <ToolBarButton>
            <ClientEvent name="onClick">view.id('dgSharePerson').set(&quot;showFilterBar&quot;,!view.id('dgSharePerson').get(&quot;showFilterBar&quot;));</ClientEvent>
            <Property name="caption">自定义查询</Property>
            <Property name="icon"> url(>skin>common/icons.gif) -20px -40px</Property>
          </ToolBarButton>
          <ToolBarButton>
            <ClientEvent name="onClick">view.id(&quot;dsBtreport&quot;).getData(&quot;#&quot;).reset(&quot;btReportSharePerson&quot;);</ClientEvent>
            <Property name="icon">url(>skin>common/icons.gif) -40px -240px</Property>
            <Property name="caption">刷新</Property>
          </ToolBarButton>
        </ToolBar>
        <DataGrid id="dgSharePerson">
          <Property name="dataSet">dsBtreport</Property>
          <Property name="dataPath">#.btReportSharePerson</Property>
          <Property name="rowHeight">22</Property>
          <Property name="readOnly">true</Property>
          <DataColumn name="userName">
            <Property name="property">userName</Property>
            <Property name="width">120</Property>
          </DataColumn>
          <DataColumn name="personName">
            <Property name="property">personName</Property>
            <Property name="width">120</Property>
          </DataColumn>
          <DataColumn name="PersonDepartment">
            <Property name="property">personDepartment</Property>
            <Property name="width">120</Property>
          </DataColumn>
          <DataColumn name="readStatus">
            <Property name="property">readStatus</Property>
            <Property name="width">120</Property>
            <Property name="align">left</Property>
          </DataColumn>
          <DataColumn name="firstReadTime">
            <Property name="property">firstReadTime</Property>
            <Property name="width">150</Property>
          </DataColumn>
          <DataColumn>
            <Property name="property">latelyReadTime</Property>
            <Property name="width">150</Property>
            <Property name="name">latelyReadTime</Property>
          </DataColumn>
        </DataGrid>
      </Children>
    </GroupBox>
    <Dialog id="diaBtreport">
      <ClientEvent name="onClose">var cur=view.id('dsBtreport').getData('#');&#xD;
				cur.cancel();&#xD;
				view.id('diaBtreport').hide();&#xD;
				&#xD;
	&#xD;
	         </ClientEvent>
      <ClientEvent name="onHide">var cur = view.id('dsBtreport').getDataAsync('#',function(cur){&#xD;
	view.checkButton(cur,'reportCheck','1');&#xD;
});</ClientEvent>
      <Property name="center">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">800</Property>
      <Property name="caption">出差报告审阅</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">view.id('uaBtreport').execute(function(){
    view.id('diaBtreport').hide();
});        </ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px 0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">var dsBtreport = view.get(&quot;#dsBtreport&quot;);
var cur=view.id('dsBtreport').getData('#');
if(cur.get(&quot;departmentHeadName&quot;) != null &amp;&amp; cur.get('sectionChiefComment') != null){
	dorado.MessageBox.confirm('您是否确认请部领导审阅此出差报告?', function(){		
		cur.set(&quot;status&quot;,2);
		view.id('uaBtreport').execute(function(){
            view.id('diaBtreport').hide();
    	});
	}); 
	
}
else{
	dorado.MessageBox.alert(&quot;请填写“审阅的部领导”与“室主任评语”&quot;);   
}        </ClientEvent>
          <Property name="caption">确定并上报</Property>
          <Property name="icon">url(>skin>common/icons.gif) -120px -240px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">var dsBtreport = view.get(&quot;#dsBtreport&quot;);
var cur=view.id('dsBtreport').getData('#');
if(cur.get('sectionChiefComment') != null){
	dorado.MessageBox.confirm('您是否确认驳回此出差报告?', function(){
		cur.set(&quot;status&quot;,0);
		view.id('uaBtreport').execute(function(){
             view.id('diaBtreport').hide();
    	});
		view.id('dsBtreport').flushAsync();	
	}); 
	
}
else{
	dorado.MessageBox.alert(&quot;请填写“室主任评语”&quot;);   
}      </ClientEvent>
          <Property name="caption">确定并驳回</Property>
          <Property name="icon">url(>skin>common/icons.gif) -140px -240px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">var cur=view.id('dsBtreport').getData('#');
				cur.cancel();
				view.id('diaBtreport').hide();
				
	
	         </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -220px -240px</Property>
        </Button>
      </Buttons>
      <Children>
        <CustomDropDown id="customDropDown1">
          <Property name="editable">false</Property>
          <Property name="autoOpen">true</Property>
          <DataGrid>
            <ClientEvent name="onDataRowClick">var dropDown = dorado.widget.DropDown.findDropDown(self);&#xD;
var user=view.id(&quot;dsUsers&quot;).getData(&quot;#&quot;);&#xD;
if (user) {&#xD;
	var cur = view.id('dsBtreport').getData('#');&#xD;
	cur.set(&quot;departmentHead&quot;,user.get(&quot;username&quot;));&#xD;
	dropDown.close(user.get(&quot;cname&quot;));&#xD;
}</ClientEvent>
            <Property name="showFilterBar">true</Property>
            <Property name="rowHeight">22</Property>
            <Property name="dataSet">dsUsers</Property>
            <Property name="readOnly">true</Property>
            <Property name="height">300</Property>
            <RowNumColumn/>
            <DataColumn>
              <Property name="name">username</Property>
              <Property name="property">username</Property>
            </DataColumn>
            <DataColumn>
              <Property name="name">cname</Property>
              <Property name="property">cname</Property>
            </DataColumn>
            <DataColumn name="depts">
              <ClientEvent name="onRenderCell">var entitylist = arg.data.get(&quot;depts&quot;);&#xD;
var name = [];&#xD;
if (entitylist) {&#xD;
	entitylist.each(function(item){&#xD;
		name.push(item.get(&quot;name&quot;));&#xD;
	});&#xD;
}&#xD;
arg.dom.innerHTML = name.join(&quot;,&quot;);</ClientEvent>
              <Property name="property">depts</Property>
              <Property name="visible">false</Property>
            </DataColumn>
            <DataColumn>
              <ClientEvent name="onRenderCell">var entitylist = arg.data.get(&quot;positions&quot;);&#xD;
var name = [];&#xD;
if (entitylist) {&#xD;
	entitylist.each(function(item){&#xD;
		name.push(item.get(&quot;name&quot;));&#xD;
	});&#xD;
}&#xD;
arg.dom.innerHTML = name.join(&quot;,&quot;);</ClientEvent>
              <Property name="name">positions</Property>
              <Property name="property">positions</Property>
              <Property name="width">120</Property>
              <Property name="filterable">true</Property>
              <Property name="visible">false</Property>
              <Editor/>
            </DataColumn>
            <DataColumn name="department">
              <Property name="property">department</Property>
              <Property name="width">70</Property>
            </DataColumn>
            <DataColumn name="position">
              <Property name="property">position</Property>
              <Property name="width">100</Property>
            </DataColumn>
          </DataGrid>
        </CustomDropDown>
        <AutoForm id="afBtreport">
          <Property name="cols">*,*</Property>
          <Property name="dataSet">dsBtreport</Property>
          <Property name="dataPath">#</Property>
          <Property name="labelWidth">100</Property>
          <AutoFormElement>
            <Property name="name">BtPersonName</Property>
            <Property name="property">btpersonName</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtPlace</Property>
            <Property name="property">btplace</Property>
            <Property name="trigger">dataSetDropDown1</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtTime</Property>
            <Property name="property">bttime</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">KeyWord</Property>
            <Property name="property">keyword</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtTask</Property>
            <Property name="property">bttask</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">JobContent</Property>
            <Property name="property">jobcontent</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">RemainedProblem</Property>
            <Property name="property">remainedproblem</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">TechnicalQuestion</Property>
            <Property name="property">technicalquestion</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">GainAndAdvice</Property>
            <Property name="property">gainandadvice</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">Conclusion</Property>
            <Property name="property">conclusion</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">miji</Property>
            <Property name="property">miji</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">writingPerson</Property>
            <Property name="name">WritingPerson</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefName</Property>
            <Property name="name">SectionChiefName</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefDate</Property>
            <Property name="name">SectionChiefDate</Property>
            <Property name="readOnly">false</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement layoutConstraint="colSpan:2">
            <Property name="property">sectionChiefComment</Property>
            <Property name="name">sectionChiefComment</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">departmentHeadName</Property>
            <Property name="name">DepartmentHeadName</Property>
            <Property name="readOnly">false</Property>
            <Property name="trigger">customDropDown1,triggerClear</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">departmentHeadDate</Property>
            <Property name="name">DepartmentHeadDate</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
        </AutoForm>
        <GroupBox>
          <Property name="caption">附件文档</Property>
          <Property name="collapseable">false</Property>
          <Property name="height">250</Property>
          <Buttons/>
          <Children>
            <ToolBar>
              <DataPilot>
                <Property name="itemCodes">pages</Property>
                <Property name="dataSet">dsBtreport</Property>
                <Property name="dataPath">#.appendixdocument</Property>
              </DataPilot>
            </ToolBar>
            <DataGrid id="dgAppendixdocument2">
              <Property name="readOnly">true</Property>
              <Property name="dataSet">dsBtreport</Property>
              <Property name="dataPath">#.appendixdocument</Property>
              <Property name="filterMode">serverSide</Property>
              <Property name="showFilterBar">true</Property>
              <Property name="rowHeight">22</Property>
              <Property name="selectionMode">multiRows</Property>
              <RowNumColumn/>
              <RowSelectorColumn/>
              <DataColumn name="efile">
                <ClientEvent name="onRenderCell">&#xD;
//点击表行可查看链接&#xD;
&#xD;
jQuery(arg.dom).empty();&#xD;
var file = arg.data.get(&quot;efile&quot;); &#xD;
var oid = view.id('dsBtreport').getData('#').get(&quot;oid&quot;);&#xD;
var href = &quot;/escmp/upload/Comm_Btreport/&quot; + oid + &quot;/&quot; + file;&#xD;
jQuery(arg.dom).xCreate({&#xD;
	tagName:&quot;A&quot;,&#xD;
	href:href,&#xD;
	content:arg.data.get(&quot;efile&quot;)&#xD;
});&#xD;
&#xD;
</ClientEvent>
                <Property name="property">efile</Property>
                <Property name="width">300</Property>
              </DataColumn>
            </DataGrid>
          </Children>
        </GroupBox>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="diaSubmitBtreport">
      <ClientEvent name="onClose">var cur=view.id('dsBtreport').getData('#');&#xD;
				cur.cancel();	         </ClientEvent>
      <ClientEvent name="onHide">var cur = view.id('dsBtreport').getDataAsync('#',function(cur){&#xD;
	view.checkButton(cur,'reportCheck','1');&#xD;
});</ClientEvent>
      <Property name="center">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">450</Property>
      <Property name="caption">出差报告提交</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var dsBtreport = view.get(&quot;#dsBtreport&quot;);
var cur=view.id('dsBtreport').getData('#');
if(cur.get(&quot;departmentHead&quot;) != null &amp;&amp; cur.get('sectionChiefComment') != null){
	dorado.MessageBox.confirm('您是否确认请部领导审阅此出差报告?', function(){
		cur.set(&quot;status&quot;,2);
		view.id('uaBtreport').execute(function(){
              	 view.id('diaSubmitBtreport').hide();
    	});
	}); 
	
}
else{
	dorado.MessageBox.alert(&quot;请填写“审阅的部领导”与“室主任评语”&quot;);   
}      </ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px 0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">var cur=view.id('dsBtreport').getData('#');
	cur.cancel();
view.id('diaSubmitBtreport').hide();
				
	
	         </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -220px -240px</Property>
        </Button>
      </Buttons>
      <Children>
        <CustomDropDown id="customDropDown2">
          <Property name="editable">false</Property>
          <Property name="autoOpen">true</Property>
          <DataGrid>
            <ClientEvent name="onDataRowClick">var dropDown = dorado.widget.DropDown.findDropDown(self);&#xD;
var user=view.id(&quot;dsUsers&quot;).getData(&quot;#&quot;);&#xD;
if (user) {	&#xD;
	var cur = view.id('dsBtreport').getData('#');&#xD;
	cur.set(&quot;departmentHead&quot;,user.get(&quot;username&quot;));	&#xD;
	dropDown.close(user.get(&quot;cname&quot;));&#xD;
}</ClientEvent>
            <Property name="showFilterBar">true</Property>
            <Property name="rowHeight">22</Property>
            <Property name="dataSet">dsUsers</Property>
            <Property name="readOnly">true</Property>
            <Property name="height">300</Property>
            <RowNumColumn/>
            <DataColumn>
              <Property name="name">username</Property>
              <Property name="property">username</Property>
            </DataColumn>
            <DataColumn>
              <Property name="name">cname</Property>
              <Property name="property">cname</Property>
            </DataColumn>
            <DataColumn name="depts">
              <ClientEvent name="onRenderCell">var entitylist = arg.data.get(&quot;depts&quot;);&#xD;
var name = [];&#xD;
if (entitylist) {&#xD;
	entitylist.each(function(item){&#xD;
		name.push(item.get(&quot;name&quot;));&#xD;
	});&#xD;
}&#xD;
arg.dom.innerHTML = name.join(&quot;,&quot;);</ClientEvent>
              <Property name="property">depts</Property>
              <Property name="visible">false</Property>
            </DataColumn>
            <DataColumn>
              <ClientEvent name="onRenderCell">var entitylist = arg.data.get(&quot;positions&quot;);&#xD;
var name = [];&#xD;
if (entitylist) {&#xD;
	entitylist.each(function(item){&#xD;
		name.push(item.get(&quot;name&quot;));&#xD;
	});&#xD;
}&#xD;
arg.dom.innerHTML = name.join(&quot;,&quot;);</ClientEvent>
              <Property name="name">positions</Property>
              <Property name="property">positions</Property>
              <Property name="width">120</Property>
              <Property name="filterable">true</Property>
              <Property name="visible">false</Property>
              <Editor/>
            </DataColumn>
            <DataColumn name="department">
              <Property name="property">department</Property>
              <Property name="width">70</Property>
            </DataColumn>
            <DataColumn name="position">
              <Property name="property">position</Property>
              <Property name="width">100</Property>
            </DataColumn>
          </DataGrid>
        </CustomDropDown>
        <AutoForm id="afSubmitBtreport">
          <Property name="cols">*</Property>
          <Property name="dataSet">dsBtreport</Property>
          <Property name="dataPath">#</Property>
          <Property name="labelWidth">100</Property>
          <AutoFormElement>
            <Property name="name">BtPersonName</Property>
            <Property name="property">btpersonName</Property>
            <Property name="trigger">customDropDown1,triggerClear</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtPlace</Property>
            <Property name="property">btplace</Property>
            <Property name="trigger">dataSetDropDown1</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtTime</Property>
            <Property name="property">bttime</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">KeyWord</Property>
            <Property name="property">keyword</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">writingPersonName</Property>
            <Property name="name">WritingPersonName</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefName</Property>
            <Property name="name">SectionChiefName</Property>
            <Property name="trigger">customDropDown2</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefComment</Property>
            <Property name="name">sectionChiefComment</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefDate</Property>
            <Property name="name">SectionChiefDate</Property>
            <Property name="readOnly">false</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">departmentHeadName</Property>
            <Property name="name">DepartmentHeadName</Property>
            <Property name="trigger">customDropDown2,triggerClear</Property>
            <Editor/>
          </AutoFormElement>
        </AutoForm>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="diaRejectBtreport">
      <ClientEvent name="onClose">var cur=view.id('dsBtreport').getData('#');&#xD;
				cur.cancel();	         </ClientEvent>
      <ClientEvent name="onHide">view.id('dsBtreport').flushAsync();	</ClientEvent>
      <Property name="center">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">450</Property>
      <Property name="caption">出差报告驳回</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var dsBtreport = view.get(&quot;#dsBtreport&quot;);
var cur=view.id('dsBtreport').getData('#');
if(cur.get('sectionChiefComment') != null){
	dorado.MessageBox.confirm('您是否确认驳回此出差报告?', function(){
		cur.set(&quot;status&quot;,0);
		view.id('uaBtreport').execute(function(){
             view.id('diaRejectBtreport').hide();
    	});
	}); 
	
}
else{
	dorado.MessageBox.alert(&quot;请填写“室主任评语”&quot;);   
}         </ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px 0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">var cur=view.id('dsBtreport').getData('#');
cur.cancel();
view.id('diaRejectBtreport').hide();			         </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -220px -240px</Property>
        </Button>
      </Buttons>
      <Children>
        <AutoForm id="afRejectBtreport">
          <Property name="cols">*</Property>
          <Property name="dataSet">dsBtreport</Property>
          <Property name="dataPath">#</Property>
          <Property name="labelWidth">100</Property>
          <AutoFormElement>
            <Property name="name">BtPersonName</Property>
            <Property name="property">btpersonName</Property>
            <Property name="trigger">customDropDown1,triggerClear</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtPlace</Property>
            <Property name="property">btplace</Property>
            <Property name="trigger">dataSetDropDown1</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtTime</Property>
            <Property name="property">bttime</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">KeyWord</Property>
            <Property name="property">keyword</Property>
            <Property name="readOnly">true</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">writingPersonName</Property>
            <Property name="name">WritingPersonName</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefName</Property>
            <Property name="name">SectionChiefName</Property>
            <Property name="trigger">customDropDown2</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefComment</Property>
            <Property name="name">sectionChiefComment</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefDate</Property>
            <Property name="name">SectionChiefDate</Property>
            <Property name="readOnly">false</Property>
            <Editor/>
          </AutoFormElement>
        </AutoForm>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="diaSeeBtreport">
      <Property name="center">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">800</Property>
      <Property name="caption">出差报告管理</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">view.id('diaSeeBtreport').hide();       </ClientEvent>
          <Property name="caption">关闭</Property>
          <Property name="icon">url(>skin>common/icons.gif) -40px -0px</Property>
        </Button>
      </Buttons>
      <Children>
        <AutoForm id="afSeeBtreport">
          <Property name="cols">*,*</Property>
          <Property name="dataSet">dsBtreport</Property>
          <Property name="dataPath">#</Property>
          <Property name="labelWidth">100</Property>
          <Property name="readOnly">true</Property>
          <AutoFormElement>
            <Property name="name">BtPersonName</Property>
            <Property name="property">btpersonName</Property>
            <Property name="trigger">customDropDown1,triggerClear</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtPlace</Property>
            <Property name="property">btplace</Property>
            <Property name="trigger">dataSetDropDown1</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtTime</Property>
            <Property name="property">bttime</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">KeyWord</Property>
            <Property name="property">keyword</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">BtTask</Property>
            <Property name="property">bttask</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">JobContent</Property>
            <Property name="property">jobcontent</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">RemainedProblem</Property>
            <Property name="property">remainedproblem</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">TechnicalQuestion</Property>
            <Property name="property">technicalquestion</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">GainAndAdvice</Property>
            <Property name="property">gainandadvice</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">Conclusion</Property>
            <Property name="property">conclusion</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">miji</Property>
            <Property name="property">miji</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">writingPersonName</Property>
            <Property name="name">WritingPersonName</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefName</Property>
            <Property name="name">SectionChiefName</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">sectionChiefDate</Property>
            <Property name="name">SectionChiefDate</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">departmentHeadName</Property>
            <Property name="name">DepartmentHeadName</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="property">departmentHeadDate</Property>
            <Property name="name">DepartmentHeadDate</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">SectionChiefComment</Property>
            <Property name="property">sectionChiefComment</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">DepartmentHeadComment</Property>
            <Property name="property">departmentHeadComment</Property>
            <Property name="editorType">TextArea</Property>
            <Property name="height">80</Property>
          </AutoFormElement>
        </AutoForm>
        <GroupBox>
          <Property name="caption">附件文档</Property>
          <Property name="collapseable">false</Property>
          <Property name="height">250</Property>
          <Buttons/>
          <Children>
            <ToolBar>
              <DataPilot>
                <Property name="itemCodes">pages</Property>
                <Property name="dataSet">dsBtreport</Property>
                <Property name="dataPath">#.appendixdocument</Property>
              </DataPilot>
            </ToolBar>
            <DataGrid id="dgSeeAppendixdocument">
              <Property name="readOnly">true</Property>
              <Property name="dataSet">dsBtreport</Property>
              <Property name="dataPath">#.appendixdocument</Property>
              <Property name="filterMode">serverSide</Property>
              <Property name="showFilterBar">true</Property>
              <Property name="rowHeight">22</Property>
              <Property name="selectionMode">multiRows</Property>
              <RowNumColumn/>
              <RowSelectorColumn/>
              <DataColumn name="efile">
                <ClientEvent name="onRenderCell">&#xD;
//点击表行可查看链接&#xD;
&#xD;
jQuery(arg.dom).empty();&#xD;
var file = arg.data.get(&quot;efile&quot;); &#xD;
var oid = view.id('dsBtreport').getData('#').get(&quot;oid&quot;);&#xD;
var href = &quot;/escmp/upload/Comm_Btreport/&quot; + oid + &quot;/&quot; + file;&#xD;
jQuery(arg.dom).xCreate({&#xD;
	tagName:&quot;A&quot;,&#xD;
	href:href,&#xD;
	content:arg.data.get(&quot;efile&quot;)&#xD;
});&#xD;
&#xD;
</ClientEvent>
                <Property name="property">efile</Property>
                <Property name="width">300</Property>
              </DataColumn>
            </DataGrid>
          </Children>
        </GroupBox>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="dialogLoad">
      <Property name="width">800</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">
    view.id('dialogLoad').hide();
           
         </ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px 0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">var entityList=view.id('dataSetFiles').getData();
entityList.each(function(entity){
	entity.cancel();
});
view.id('dialogLoad').hide();

	         </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -220px -240px</Property>
        </Button>
      </Buttons>
      <Children>
        <Panel>
          <Property name="caption">批量附件上传</Property>
          <Property name="style">
            <Property name="margin">15px</Property>
          </Property>
          <Property name="width">800</Property>
          <Property name="height">400</Property>
          <Buttons/>
          <Children>
            <ToolBar>
              <ToolBarButton>
                <Property name="caption">添加文件</Property>
                <Property name="icon">url(>skin>common/icons.gif) -120px 0px</Property>
                <Property name="action">batchUpload</Property>
              </ToolBarButton>
              <ToolBarButton>
                <ClientEvent name="onClick">var uploadAction = view.get('#batchUpload');&#xD;
var dataset = view.get('#dataSetFiles');&#xD;
var selections = view.get('#dataGridFiles.selection');&#xD;
&#xD;
if(!selections){&#xD;
	return;&#xD;
}&#xD;
&#xD;
if(!selections.length){&#xD;
	selections = [selections];&#xD;
}&#xD;
&#xD;
var selectionCopy = [];&#xD;
for (var i = 0; i &lt; selections.length; i++) {&#xD;
	selectionCopy.push(selections[i]);&#xD;
}&#xD;
&#xD;
for(var i=0;i&lt;selectionCopy.length;i++){&#xD;
	var entity = selectionCopy[i];&#xD;
	uploadAction.removeFile(entity.get('id'));&#xD;
	entity.remove();&#xD;
}</ClientEvent>
                <Property name="caption">删除文件</Property>
                <Property name="icon">url(>skin>common/icons.gif) -140px 0px</Property>
              </ToolBarButton>
              <Separator/>
              <ToolBarButton>
                <ClientEvent name="onClick">view.get('#batchUpload').start();&#xD;
&#xD;
	/*&#xD;
 	 * 对用户新增操作进行记录，在用户操作日志表中新增一条记录。&#xD;
 	 */&#xD;
	var myDate = new Date();&#xD;
	view.id('dsUserOperationLog').getData().insert({&#xD;
		logOperationType:&quot;1&quot;,&#xD;
		operationPerson: &quot;${loginUsername}&quot;,&#xD;
		operationContent:&quot;对出差报告管理表子表附件文档表新增选定记录&quot;,&#xD;
		operationTime:myDate&#xD;
	});&#xD;
	view.id('uaUserOperationLog').execute();</ClientEvent>
                <Property name="caption">开始上传</Property>
                <Property name="icon">url(>skin>common/icons.gif) -180px -220px</Property>
              </ToolBarButton>
              <ToolBarButton>
                <ClientEvent name="onClick">view.get('#batchUpload').stop();</ClientEvent>
                <Property name="caption">停止上传</Property>
                <Property name="icon">url(>skin>common/icons.gif) -260px -220px</Property>
              </ToolBarButton>
            </ToolBar>
            <DataSet id="dataSetFiles">
              <ClientEvent name="onCreate">self.set([]);</ClientEvent>
              <Property name="dataType">[dataTypeFiles]</Property>
            </DataSet>
            <DataGrid id="dataGridFiles">
              <ClientEvent name="onCreate">var ProgressCellRenderer = $extend(dorado.widget.grid.SubControlCellRenderer, {&#xD;
    createSubControl: function(arg) {&#xD;
        return new dorado.widget.ProgressBar({&#xD;
            value:arg.data.get(&quot;percent&quot;)&#xD;
        });&#xD;
    },&#xD;
&#xD;
    refreshSubControl: function(progressBar, arg) {&#xD;
		progressBar.set(&quot;value&quot;,arg.data.get(&quot;percent&quot;));&#xD;
        progressBar.refresh();&#xD;
    }&#xD;
});&#xD;
&#xD;
self.set(&quot;&amp;percent.renderer&quot;,new ProgressCellRenderer());</ClientEvent>
              <Property name="dataSet">dataSetFiles</Property>
              <Property name="selectionMode">multiRows</Property>
              <Property name="dataType">dataTypeFiles</Property>
              <RowNumColumn/>
              <RowSelectorColumn/>
              <DataColumn name="name">
                <Property name="property">name</Property>
              </DataColumn>
              <DataColumn name="size">
                <ClientEvent name="onRenderCell">arg.dom.innerHTML = prettySize(arg.data.get('size'));&#xD;
</ClientEvent>
                <Property name="property">size</Property>
              </DataColumn>
              <DataColumn name="percent">
                <Property name="property">percent</Property>
              </DataColumn>
              <DataColumn name="status">
                <Property name="property">status</Property>
              </DataColumn>
            </DataGrid>
            <UploadAction id="batchUpload">
              <ClientEvent name="onError">var error = arg.error;&#xD;
dorado.MessageBox.show({&#xD;
	title:error.message,&#xD;
	message:error.file.name + &quot; 超过大小限制:&quot;+ self.get('maxFileSize'),&#xD;
	icon: &quot;ERROR&quot;,&#xD;
	buttons: [&quot;ok&quot;]&#xD;
});&#xD;
</ClientEvent>
              <ClientEvent name="onFileUploaded">var file = arg.file;//file：完成上传的文件&#xD;
var entity = view.get('#dataSetFiles').getData(&quot;[@.get('id')=='&quot;+file.id+&quot;']&quot;);&#xD;
entity.set('percent',100);&#xD;
entity.set('status',file.status);&#xD;
&#xD;
&#xD;
//建立链接&#xD;
&#xD;
var entityBtreport=view.id('dsBtreport').getData('#');&#xD;
var returnValue = arg.file.name;&#xD;
view.id('dsBtreport').getData('#.appendixdocument').insert({btreport:{oid:entityBtreport.get('oid')}});&#xD;
var cur=view.id('dsBtreport').getData('#.#appendixdocument');&#xD;
cur.set(&quot;efile&quot;,returnValue);&#xD;
var link = view.id(&quot;lefile&quot;);&#xD;
if(returnValue){&#xD;
	var oid = entityBtreport.get(&quot;oid&quot;);&#xD;
    var href = &quot;/escmp/upload/Comm_Btreport/&quot; + oid + &quot;/&quot; + returnValue;&#xD;
	&#xD;
   /*link.set({&#xD;
		href: href,&#xD;
		visible: true&#xD;
	});*/&#xD;
}&#xD;
else{&#xD;
    link.set(&quot;visible&quot;,false);&#xD;
}&#xD;
</ClientEvent>
              <ClientEvent name="uploadProgress">var file = arg.file;&#xD;
view.get('#dataSetFiles').getData(&quot;[@.get('id')=='&quot;+file.id+&quot;']&quot;).set('percent',file.percent);&#xD;
&#xD;
&#xD;
</ClientEvent>
              <ClientEvent name="onFilesAdded">//多文件上传&#xD;
arg.files.each(function(file){&#xD;
	view.get('#dataSetFiles').insert({&#xD;
		id : file.id,&#xD;
		name : file.name,&#xD;
		size : file.size,&#xD;
		percent : file.percent,&#xD;
		status : file.status&#xD;
	});&#xD;
	&#xD;
});&#xD;
&#xD;
//设置文件夹？传入后台&#xD;
var cur=view.id('dsBtreport').getData('#');&#xD;
var value = &quot;/Comm_Btreport/&quot; + cur.get(&quot;oid&quot;) + &quot;/&quot;;&#xD;
self.set(&quot;multipartParams&quot;, {record: value});&#xD;
&#xD;
&#xD;
&#xD;
</ClientEvent>
              <Property name="autoUpload">false</Property>
              <Property name="url">>dorado/uploader/fileupload</Property>
              <Filters/>
            </UploadAction>
          </Children>
          <Tools/>
        </Panel>
      </Children>
      <Tools/>
    </Dialog>
    <AjaxAction id="deleteFileAction">
      <ClientEvent name="beforeExecute">/*var file;&#xD;
var selections = view.get(&quot;#dgAppendixdocument2.selection&quot;);&#xD;
	var tmpList=selections.slice(0);&#xD;
	var files = view.id('dsBtreport').getData('#.appendixdocument');&#xD;
	if(tmpList.length){&#xD;
			&#xD;
	tmpList.each(function(entity){&#xD;
			file=files.each(function(f){&#xD;
					if(entity==f)&#xD;
					return f;&#xD;
				})&#xD;
&#xD;
		&#xD;
		});&#xD;
		&#xD;
	&#xD;
	}&#xD;
&#xD;
 	 var cur=view.id('dsBtreport').getData('#');&#xD;
var value = &quot;/Comm_Btreport/&quot; + cur.get(&quot;oid&quot;) + &quot;/&quot;;&#xD;
var file = view.id('dsBtreport').getData('#.#appendixdocument').get(&quot;efile&quot;);&#xD;
&#xD;
self.set(&quot;parameter&quot;,{&#xD;
	record: value,&#xD;
	filename: file&#xD;
});&#xD;
&#xD;
cur.set(&quot;efile&quot;,null);&#xD;
var link = view.id(&quot;lefile&quot;);&#xD;
link.set(&quot;visible&quot;,false);*/&#xD;
</ClientEvent>
      <Property name="service">defaultUploadProcessor#deleteFile</Property>
      <Property name="modal">false</Property>
    </AjaxAction>
    <Dialog id="diaSeeSharePerson">
      <Property name="center">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">450</Property>
      <Property name="caption">报告共享人管理</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">view.id('diaSeeSharePerson').hide();       </ClientEvent>
          <Property name="caption">关闭</Property>
          <Property name="icon">url(>skin>common/icons.gif) -40px -0px</Property>
        </Button>
      </Buttons>
      <Children>
        <AutoForm id="afSeeSharePerson">
          <Property name="cols">*</Property>
          <Property name="dataSet">dsBtreport</Property>
          <Property name="dataPath">#.#btReportSharePerson</Property>
          <Property name="labelWidth">100</Property>
          <Property name="readOnly">true</Property>
          <AutoFormElement>
            <Property name="name">personName</Property>
            <Property name="property">personName</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">userName</Property>
            <Property name="property">userName</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">readStatus</Property>
            <Property name="property">readStatus</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">firstReadTime</Property>
            <Property name="property">firstReadTime</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">latelyReadTime</Property>
            <Property name="property">latelyReadTime</Property>
            <Editor/>
          </AutoFormElement>
        </AutoForm>
      </Children>
      <Tools/>
    </Dialog>
  </View>
</ViewConfig>
